import{c as s}from"./vidstack-Crcwig_k.js";import{c as i}from"./vidstack-DV8S-iAx.js";import{l as c}from"./vidstack-D0IjUeMf.js";import{I as n,a as l}from"./vidstack-D_20QMRw.js";import{a as p,b as g,i as r,d as m,e as d,c as h,f as y,j as w}from"./vidstack-CRGod2fE.js";import{p as f,D as C}from"./vidstack-DiG3_DXK.js";import"./vidstack-CNFQhJsI.js";class v{constructor(){this.name="google-cast"}get cast(){return p()}mediaType(){return"video"}canPlay(t){return n&&!l&&i(t)}async prompt(t){let a;try{const e=await this.Pl(t);this.aa||(this.aa=new cast.framework.RemotePlayer,new cast.framework.RemotePlayerController(this.aa)),a=t.player.createEvent("google-cast-prompt-open",{trigger:e}),t.player.dispatchEvent(a),this.pm(t,"connecting",a),await this.Rl(f(t.$props.googleCast)),t.$state.remotePlaybackInfo.set({deviceName:g()?.getCastDevice().friendlyName}),r()&&this.pm(t,"connected",a)}catch(e){const o=s(e);throw this.pm(t,r()?"connected":"disconnected",new C("google-cast-prompt-error",{detail:o})),o}finally{t.player.dispatch("google-cast-prompt-close",{trigger:a})}}async load(t){if(!this.aa)throw Error("[vidstack] google cast player was not initialized");return new(await import("../providers/vidstack-google-cast.js")).GoogleCastProvider(this.aa,t)}async Pl(t){if(m())return;const a=t.player.createEvent("google-cast-load-start");t.player.dispatch(a),await c(w()),await customElements.whenDefined("google-cast-launcher");const e=t.player.createEvent("google-cast-loaded",{trigger:a});if(t.player.dispatch(e),!d())throw Error("Cast not available.");return e}async Rl(t){this.Tl(t);const a=await this.cast.requestSession();if(a)throw Error(h(a))}Tl(t){this.cast?.setOptions({...y(),...t})}pm(t,a,e){const o={type:"google-cast",state:a};t.delegate.c("remote-playback-change",o,e)}}export{v as GoogleCastLoader};
